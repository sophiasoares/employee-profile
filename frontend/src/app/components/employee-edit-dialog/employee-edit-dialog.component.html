@if (isOpen) {
  <div class="dialog-overlay" (click)="onClose()">
    <div class="dialog-container" (click)="$event.stopPropagation()">
      <div class="dialog-header">
        <h2>
          <i class="fas fa-user-edit"></i>
          Edit Employee
        </h2>
        <button class="close-button" (click)="onClose()" type="button">
          <i class="fas fa-times"></i>
        </button>
      </div>

      <form [formGroup]="editForm" (ngSubmit)="onSubmit()" class="dialog-content">
        @if (errorMessage) {
          <div class="error-message">
            <i class="fas fa-exclamation-triangle"></i>
            {{ errorMessage }}
          </div>
        }

        <!-- Personal info -->
        <div class="form-section">
          <h3>
            <i class="fas fa-user"></i>
            Personal Information
          </h3>
          
          <div class="form-row">
            <div class="form-group">
              <label for="firstName">First Name *</label>
              <input
                id="firstName"
                type="text"
                formControlName="firstName"
                class="form-control"
                [class.error]="getFieldError('firstName')"
              />
              @if (getFieldError('firstName')) {
                <span class="field-error">{{ getFieldError('firstName') }}</span>
              }
            </div>

            <div class="form-group">
              <label for="lastName">Last Name *</label>
              <input
                id="lastName"
                type="text"
                formControlName="lastName"
                class="form-control"
                [class.error]="getFieldError('lastName')"
              />
              @if (getFieldError('lastName')) {
                <span class="field-error">{{ getFieldError('lastName') }}</span>
              }
            </div>
          </div>

          <div class="form-row">
            <div class="form-group">
              <label for="email">Email *</label>
              <input
                id="email"
                type="email"
                formControlName="email"
                class="form-control"
                [class.error]="getFieldError('email')"
              />
              @if (getFieldError('email')) {
                <span class="field-error">{{ getFieldError('email') }}</span>
              }
            </div>

            <div class="form-group">
              <label for="phoneNumber">Phone Number</label>
              <input
                id="phoneNumber"
                type="tel"
                formControlName="phoneNumber"
                class="form-control"
                [class.error]="getFieldError('phoneNumber')"
                placeholder="+49123456789"
              />
              @if (getFieldError('phoneNumber')) {
                <span class="field-error">{{ getFieldError('phoneNumber') }}</span>
              }
            </div>
          </div>

          <div class="form-group">
            <label for="address">Address</label>
            <input
              id="address"
              type="text"
              formControlName="address"
              class="form-control"
              [class.error]="getFieldError('address')"
            />
            @if (getFieldError('address')) {
              <span class="field-error">{{ getFieldError('address') }}</span>
            }
          </div>
        </div>

        <!-- Employment info -->
        <div class="form-section">
          <h3>
            <i class="fas fa-briefcase"></i>
            Employment Information
          </h3>
          
          <div class="form-row">
            <div class="form-group">
              <label for="employeeId">Employee ID *</label>
              <input
                id="employeeId"
                type="text"
                formControlName="employeeId"
                class="form-control"
                [class.error]="getFieldError('employeeId')"
              />
              @if (getFieldError('employeeId')) {
                <span class="field-error">{{ getFieldError('employeeId') }}</span>
              }
            </div>

            <div class="form-group">
              <label for="position">Position *</label>
              <input
                id="position"
                type="text"
                formControlName="position"
                class="form-control"
                [class.error]="getFieldError('position')"
              />
              @if (getFieldError('position')) {
                <span class="field-error">{{ getFieldError('position') }}</span>
              }
            </div>
          </div>

          <div class="form-row">
            <div class="form-group">
              <label for="department">Department *</label>
              <input
                id="department"
                type="text"
                formControlName="department"
                class="form-control"
                [class.error]="getFieldError('department')"
              />
              @if (getFieldError('department')) {
                <span class="field-error">{{ getFieldError('department') }}</span>
              }
            </div>

            <div class="form-group">
              <label for="employmentType">Employment Type *</label>
              <select
                id="employmentType"
                formControlName="employmentType"
                class="form-control"
                [class.error]="getFieldError('employmentType')"
              >
                @for (type of employmentTypes; track type) {
                  <option [value]="type">{{ formatEmploymentType(type) }}</option>
                }
              </select>
              @if (getFieldError('employmentType')) {
                <span class="field-error">{{ getFieldError('employmentType') }}</span>
              }
            </div>
          </div>

          <div class="form-row">
            <div class="form-group">
              <label for="hireDate">Hire Date *</label>
              <input
                id="hireDate"
                type="date"
                formControlName="hireDate"
                class="form-control"
                [class.error]="getFieldError('hireDate')"
              />
              @if (getFieldError('hireDate')) {
                <span class="field-error">{{ getFieldError('hireDate') }}</span>
              }
            </div>

            <div class="form-group">
              <label for="salary">Salary (EUR)</label>
              <input
                id="salary"
                type="number"
                formControlName="salary"
                class="form-control"
                [class.error]="getFieldError('salary')"
                min="0"
                step="1000"
                placeholder="50000"
              />
              @if (getFieldError('salary')) {
                <span class="field-error">{{ getFieldError('salary') }}</span>
              }
            </div>
          </div>
        </div>

        <!-- profile info -->
        <div class="form-section">
          <h3>
            <i class="fas fa-id-card"></i>
            Profile Information
          </h3>
          
          <div class="form-group">
            <label for="bio">Bio</label>
            <textarea
              id="bio"
              formControlName="bio"
              class="form-control"
              [class.error]="getFieldError('bio')"
              rows="3"
              placeholder="Brief description about the employee..."
            ></textarea>
            @if (getFieldError('bio')) {
              <span class="field-error">{{ getFieldError('bio') }}</span>
            }
          </div>

          <div class="form-group">
            <label for="skills">Skills</label>
            <textarea
              id="skills"
              formControlName="skills"
              class="form-control"
              [class.error]="getFieldError('skills')"
              rows="2"
              placeholder="Java, Angular, TypeScript, etc."
            ></textarea>
            @if (getFieldError('skills')) {
              <span class="field-error">{{ getFieldError('skills') }}</span>
            }
          </div>

          <div class="form-group">
            <label for="profilePictureUrl">Profile Picture URL</label>
            <input
              id="profilePictureUrl"
              type="url"
              formControlName="profilePictureUrl"
              class="form-control"
              [class.error]="getFieldError('profilePictureUrl')"
              placeholder="https://example.com/profile.jpg"
            />
            @if (getFieldError('profilePictureUrl')) {
              <span class="field-error">{{ getFieldError('profilePictureUrl') }}</span>
            }
          </div>
        </div>

        <!-- dialog actions -->
        <div class="dialog-actions">
          <button type="button" class="btn-secondary" (click)="onClose()" [disabled]="isSubmitting">
            <i class="fas fa-times"></i>
            Cancel
          </button>
          <button type="submit" class="btn-primary" [disabled]="editForm.invalid || isSubmitting">
            @if (isSubmitting) {
              <i class="fas fa-spinner fa-spin"></i>
              Saving...
            } @else {
              <i class="fas fa-save"></i>
              Save Changes
            }
          </button>
        </div>
      </form>
    </div>
  </div>
}
